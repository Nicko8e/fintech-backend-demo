const express = require("express");
const data = require('./data');

server = express();
server.use(express.json());

router = express.Router();

router.get("/user/all", (request, response) => {
    let user = data.get_all_users;
    response.send(users)
})

router.get("/user/by-uid", (request, response) => {
    let user_id = request.query.user_id;
    let user = data.get_user_by_user_id(user_id);
    response.send(user);
})

router.post("/user/add", (request,response) => {
    //Step 1: need to get the user object from the request
    let user = request.body;

    //Step 2: 
    data.add_user(user);

    //Step 3: Return the success response
    response.send("Added Successfully!");
});

router.post("/account/all", (request, response) => {
    // Step 1 - Get all the accounts
    let accounts = data.get_all_accounts();

    // Step 2 - Return the accounts as response
    response.send(accounts);
});

router.get("/account/by-aid", (request, response) {
    // Step 1 - Extract the account_id from the request
    let account_id = request.query.account_id;

    //Step 2 - Get the account information from the data
    let account = data.get_account_by_account_id(account_id);

    // Step 3 - Return the account information
    response.send(account);
})

router.post("/account/add", (request,response) => {
    let account = request.body;
    data.add_account(account);
    response.send("Added Successfully!");
});

router.get("/", (request,response) =>{
    response.send("Welcome to Dev Toolkit #2!");
})

router.get("/sum", (request,response) => {
    let x = parseFloat(request.query.x);
    let y = parseFloat(request.query.y);
    let sum = x + y;

    response.send("Sum is: " + sum);
})

router.post("/create", (request,response) => {
    let name = request.body.name;
    let phone = request.body.phone;
    let age = request.body.age;

    console.log("Name: " + name);
    console.log("Phone: " + phone);
    console.log("Age: " + age);
})
server.use(router);

server.listen(3000,(errors) => {
    if (errors) {
        console.log("Server couldn't start. Error: " + errors);
    }
    else {
        console.log("Server started on port 3000");
    }
})
